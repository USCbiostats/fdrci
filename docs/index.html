<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Permutation-Based FDR Point and Confidence Interval Estimation • fdrci</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">fdrci</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    

    
    
<div class="contents">

<p><a href="https://ci.appveyor.com/project/gvegayon/fdrci"><img src="https://ci.appveyor.com/api/projects/status/jykjw0b9f5rc9g7w?svg=true" alt="Build status"></a></p>
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="fdrci" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#fdrci" class="anchor"></a>fdrci</h1></div>
<blockquote>
<p>FDR functions for permutation-based estimators, including pi0 as well as FDR confidence intervals. The confidence intervals account for dependencies between tests by the incorporation of an overdispersion parameter, which is estimated from the permuted data. — From the package description</p>
</blockquote>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install fdrci from GitHub with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages("devtools")</span>
devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"USCbiostats/fdrci"</span>)</code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>This is a basic example which shows you how to solve a common problem:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(fdrci)

ss =<span class="st"> </span><span class="dv">100</span>
nvar =<span class="st"> </span><span class="dv">100</span>
X =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">matrix</span>(<span class="kw">rnorm</span>(ss<span class="op">*</span>nvar),<span class="dt">nrow=</span>ss,<span class="dt">ncol=</span>nvar))
Y =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">matrix</span>(<span class="kw">rnorm</span>(ss<span class="op">*</span>nvar),<span class="dt">nrow=</span>ss,<span class="dt">ncol=</span>nvar))
nperm =<span class="st"> </span><span class="dv">10</span>

myanalysis =<span class="st"> </span><span class="cf">function</span>(X,Y){
    ntests =<span class="st"> </span><span class="kw">ncol</span>(X)
    rslts =<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dt">nrow=</span>ntests,<span class="dt">ncol=</span><span class="dv">2</span>))
    <span class="kw">names</span>(rslts) =<span class="st"> </span><span class="kw">c</span>(<span class="st">"ID"</span>,<span class="st">"pvalue"</span>)
    rslts[,<span class="st">"ID"</span>] =<span class="st"> </span><span class="dv">1</span><span class="op">:</span>ntests
    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>ntests){
        fit =<span class="st"> </span><span class="kw">cor.test</span>(X[,i],Y[,i],<span class="dt">na.action=</span><span class="st">"na.exclude"</span>,
            <span class="dt">alternative=</span><span class="st">"two.sided"</span>,<span class="dt">method=</span><span class="st">"pearson"</span>)
        rslts[i,<span class="st">"pvalue"</span>] =<span class="st"> </span>fit<span class="op">$</span>p.value
    }
    <span class="kw">return</span>(rslts)
} <span class="co"># End myanalysis</span>

<span class="co"># Generate observed results</span>
obs =<span class="st"> </span><span class="kw">myanalysis</span>(X,Y)

<span class="co"># Generate permuted results</span>
perml =<span class="st"> </span><span class="kw">vector</span>(<span class="st">'list'</span>,nperm)
<span class="cf">for</span>(p_ <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nperm){
    X1 =<span class="st"> </span>X[<span class="kw">order</span>(<span class="kw">runif</span>(nvar)),]
    perml[[p_]] =<span class="st"> </span><span class="kw">myanalysis</span>(X1,Y)
}

<span class="co"># FDR results table</span>
myfdrtbl =<span class="st"> </span><span class="kw"><a href="reference/fdrTbl.html">fdrTbl</a></span>(obs<span class="op">$</span>pvalue,perml,<span class="st">"pvalue"</span>,nvar,<span class="dv">0</span>,<span class="dv">3</span>)
<span class="co"># Plot results</span>
<span class="kw"><a href="reference/FDRplot.html">FDRplot</a></span>(myfdrtbl,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dt">annot=</span><span class="st">"A. An Example"</span>)
<span class="co">#&gt; Warning: Removed 10 rows containing missing values (geom_path).</span>
<span class="co">#&gt; Warning: Removed 10 rows containing missing values (geom_point).</span>
<span class="co">#&gt; Warning: Removed 10 rows containing missing values (geom_text).</span></code></pre></div>
<p><img src="reference/figures/README-example-1.png" width="100%"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2 class="hasAnchor">
<a href="#sidebar" class="anchor"></a>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cran.r-project.org/package=fdrci">https://​cran.r-project.org/​package=fdrci</a>
</li>
</ul>
<h2>License</h2>
<p><a href="https://www.r-project.org/Licenses/Artistic-2.0">Artistic-2.0</a></p>
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing fdrci</a></li>
</ul>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Joshua Millstein <br><small class="roles"> Author, maintainer </small> </li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/USCbiostats/fdrci"><img src="https://travis-ci.org/USCbiostats/fdrci.svg?branch=master" alt="Travis build status"></a></li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Joshua Millstein.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
