<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Permutation-Based FDR and Confidence Interval — fdr_od • fdrci</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">fdrci</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Permutation-Based FDR and Confidence Interval</h1>
    </div>

    
    <p>This function can be used to estimate FDR, corresponding confidence
interval, and pi0, the proportion of true null hypotheses, given a selected
significance threshold, and results from permuted data.</p>
    

    <pre class="usage"><span class='fu'>fdr_od</span>(<span class='no'>obsp</span>, <span class='no'>permp</span>, <span class='no'>pnm</span>, <span class='no'>ntests</span>, <span class='no'>thres</span>, <span class='kw'>cl</span> <span class='kw'>=</span> <span class='fl'>0.95</span>, <span class='kw'>c1</span> <span class='kw'>=</span> <span class='fl'>NA</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>obsp</th>
      <td><p>observed vector of p-values.</p></td>
    </tr>
    <tr>
      <th>permp</th>
      <td><p>list of dataframes that include a column of permutation
p-values (or statistics) in each. The length of the list permp = number of
permutations.</p></td>
    </tr>
    <tr>
      <th>pnm</th>
      <td><p>name of column in each list component dataframe that includes
p-values (or statistics).</p></td>
    </tr>
    <tr>
      <th>ntests</th>
      <td><p>total number of observed tests, which is usually the same as
the length of obsp and the number of rows in each permp dataframe. However,
this may not be the case if results were filtered by a p-value threshold or
statistic threshold. If filtering was conducted then thres must be smaller
(more extreme) than the filtering criterion.</p></td>
    </tr>
    <tr>
      <th>thres</th>
      <td><p>significance threshold.</p></td>
    </tr>
    <tr>
      <th>cl</th>
      <td><p>confidence level (default is .95).</p></td>
    </tr>
    <tr>
      <th>c1</th>
      <td><p>overdispersion parameter. If this parameter is not specified
(default initial value is NA), then the parameter is estimated from the
data. If all tests are known to be independent, then this parameter should
be set to 1.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list which includes:</p>
<dt>FDR </dt><dd><p>FDR point estimate</p></dd> <dt>ll
</dt><dd><p>lower confidence limit</p></dd> <dt>ul </dt><dd><p>upper confidence limit</p></dd> <dt>pi0
</dt><dd><p>proportion of true null hypotheses</p></dd> <dt>c1 </dt><dd><p>overdispersion parameter</p></dd>
<dt>S </dt><dd><p>observed number of positive tests</p></dd> <dt>Sp </dt><dd><p>total number of
positive tests summed across all permuted result sets</p></dd>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If a very large number of tests are conducted, it may be useful to filter
results, that is, save only results of those tests that meet some relaxed
nominal significance threshold. This alleviates the need to record results
for tests that are clearly non-significant. Results from fdr_od() are valid
as long as thres &lt; the relaxed nomimal significance threshold for both
observed and permuted results. It is not necessary for the input to fdr_od()
to be p-values, however, fdr_od() is designed for statistics in which
smaller values are more extreme than larger values as is the case for
p-values. Therefore, if raw statistics are used, then a transformation may
be necessary to insure that smaller values are more likely associated with
false null hypotheses than larger values. In certain situations, for
instance when a large proportion of tests meet the significance threshold,
pi0 is estimated to be very small, and thus has a large influence on the FDR
estimate. To limit this influence, pi0 is constrained to be .5 or greater,
resulting in a more conservative estimate under these conditions.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Millstein J, Volfson D. 2013. Computationally efficient
permutation-based confidence interval estimation for tail-area FDR.
Frontiers in Genetics | Statistical Genetics and Methodology 4(179):1-11.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='no'>ss</span><span class='kw'>=</span><span class='fl'>100</span>
<span class='no'>nvar</span><span class='kw'>=</span><span class='fl'>100</span>
<span class='no'>X</span> <span class='kw'>=</span> <span class='fu'>as.data.frame</span>(<span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='no'>ss</span>*<span class='no'>nvar</span>),<span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>ss</span>,<span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>nvar</span>))
<span class='no'>e</span> <span class='kw'>=</span> <span class='fu'>as.data.frame</span>(<span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='no'>ss</span>*<span class='no'>nvar</span>),<span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>ss</span>,<span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>nvar</span>))
<span class='no'>Y</span> <span class='kw'>=</span> <span class='fl'>.1</span>*<span class='no'>X</span> + <span class='no'>e</span>
<span class='no'>nperm</span> <span class='kw'>=</span> <span class='fl'>10</span>

<span class='no'>myanalysis</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>X</span>,<span class='no'>Y</span>){
        <span class='no'>ntests</span> <span class='kw'>=</span> <span class='fu'>ncol</span>(<span class='no'>X</span>)
        <span class='no'>rslts</span> <span class='kw'>=</span> <span class='fu'>as.data.frame</span>(<span class='fu'>matrix</span>(<span class='fl'>NA</span>,<span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>ntests</span>,<span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>2</span>))
        <span class='fu'>names</span>(<span class='no'>rslts</span>) <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"ID"</span>,<span class='st'>"pvalue"</span>)
        <span class='no'>rslts</span>[,<span class='st'>"ID"</span>] <span class='kw'>=</span> <span class='fl'>1</span>:<span class='no'>ntests</span>
        <span class='kw'>for</span>(<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='no'>ntests</span>){
                <span class='no'>fit</span> <span class='kw'>=</span> <span class='fu'>cor.test</span>(<span class='no'>X</span>[,<span class='no'>i</span>],<span class='no'>Y</span>[,<span class='no'>i</span>],<span class='kw'>na.action</span><span class='kw'>=</span><span class='st'>"na.exclude"</span>,
                        <span class='kw'>alternative</span><span class='kw'>=</span><span class='st'>"two.sided"</span>,<span class='kw'>method</span><span class='kw'>=</span><span class='st'>"pearson"</span>)
                <span class='no'>rslts</span>[<span class='no'>i</span>,<span class='st'>"pvalue"</span>] <span class='kw'>=</span> <span class='no'>fit</span>$<span class='no'>p.value</span>
        }
        <span class='fu'>return</span>(<span class='no'>rslts</span>)
} <span class='co'># End myanalysis</span>

<span class='co'># Generate observed results</span>
<span class='no'>obs</span> <span class='kw'>=</span> <span class='fu'>myanalysis</span>(<span class='no'>X</span>,<span class='no'>Y</span>)

<span class='co'>## Generate permuted results</span>
<span class='no'>perml</span> <span class='kw'>=</span> <span class='fu'>vector</span>(<span class='st'>'list'</span>,<span class='no'>nperm</span>)
<span class='kw'>for</span>(<span class='no'>p_</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='no'>nperm</span>){
        <span class='no'>X1</span> <span class='kw'>=</span> <span class='no'>X</span>[<span class='fu'>order</span>(<span class='fu'>runif</span>(<span class='no'>nvar</span>)),]
        <span class='no'>perml</span><span class='kw'>[[</span><span class='no'>p_</span>]] <span class='kw'>=</span> <span class='fu'>myanalysis</span>(<span class='no'>X1</span>,<span class='no'>Y</span>)
}

<span class='co'>## FDR results</span>
<span class='fu'>fdr_od</span>(<span class='no'>obs</span>$<span class='no'>pvalue</span>,<span class='no'>perml</span>,<span class='st'>"pvalue"</span>,<span class='no'>nvar</span>,<span class='fl'>.05</span>)</div><div class='output co'>#&gt;        fdr         ll         ul        pi0         c1          S         Sp 
#&gt;  0.3061199  0.1697313  0.5521045  0.8820404  1.0186703 17.0000000 59.0000000 </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Joshua Millstein

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Joshua Millstein.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
